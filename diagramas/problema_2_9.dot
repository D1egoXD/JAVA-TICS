digraph CalculoImpuestos {
    // Configuración general
    rankdir=TB;
    node [shape=box, style=filled, fontname="Arial", fontsize=11];
    edge [fontname="Arial", fontsize=10, color=black, arrowsize=0.8];

    // Nodo inicial (óvalo verde)
    start [label="INICIO", shape=oval, fillcolor="#90EE90", style="filled", width=1.5, height=0.8];

    // Nodo de entrada - leer PREBAS
    readPrebas [label="Leer PREBAS", shape=parallelogram, fillcolor="#FFFACD", style="filled", skew=0.3];

    // Primera decisión: PREBAS > 500
    decision1 [label="PREBAS\n> 500?", shape=diamond, fillcolor="#ADD8E6", style="filled", width=1.8];

    // Cálculo IMP para > 500
    calcImp500 [label="IMP ← 20*0.30 +\n(PREBAS-40)*0.50", shape=rectangle, fillcolor="#ADD8E6", style="filled"];

    // Segunda decisión: PREBAS > 40
    decision2 [label="PREBAS\n> 40?", shape=diamond, fillcolor="#ADD8E6", style="filled", width=1.8];

    // Cálculo IMP para > 40
    calcImp40 [label="IMP ← 20*0.30 +\n(PREBAS-40)*0.40", shape=rectangle, fillcolor="#ADD8E6", style="filled"];

    // Tercera decisión: PREBAS > 20
    decision3 [label="PREBAS\n> 20?", shape=diamond, fillcolor="#ADD8E6", style="filled", width=1.8];

    // Cálculo IMP para > 20
    calcImp20 [label="IMP ← (PREBAS-20)\n*0.30", shape=rectangle, fillcolor="#ADD8E6", style="filled"];

    // Cálculo IMP para <= 20
    calcImp0 [label="IMP ← 0", shape=rectangle, fillcolor="#ADD8E6", style="filled"];

    // Punto de convergencia
    convergencia [label="", shape=circle, fillcolor=black, width=0.15, height=0.15];

    // Cálculo del precio total
    calcPretot [label="PRETOT ← PREBAS + IMP", shape=rectangle, fillcolor="#ADD8E6", style="filled"];

    // Nodo de salida
    writeOutput [label="Escribir PREBAS, PRETOT", shape=parallelogram, fillcolor="#FFFACD", style="filled", skew=0.3];

    // Nodo final (óvalo rojo/coral)
    end [label="FIN", shape=oval, fillcolor="#F08080", style="filled", width=1.5, height=0.8];

    // Conexiones
    start -> readPrebas;
    readPrebas -> decision1;

    // Primera decisión
    decision1 -> calcImp500 [label="Sí"];
    decision1 -> decision2 [label="No"];

    // Segunda decisión
    decision2 -> calcImp40 [label="Sí"];
    decision2 -> decision3 [label="No"];

    // Tercera decisión
    decision3 -> calcImp20 [label="Sí"];
    decision3 -> calcImp0 [label="No"];

    // Convergencia de todas las ramas
    calcImp500 -> convergencia;
    calcImp40 -> convergencia;
    calcImp20 -> convergencia;
    calcImp0 -> convergencia;

    // Continuar después de convergencia
    convergencia -> calcPretot;
    calcPretot -> writeOutput;
    writeOutput -> end;
}

    // Segunda decisión
    decision2 -> calc_imp_40 [label="Sí"];
    decision2 -> decision3 [label="No"];

    // Tercera decisión
    decision3 -> calc_imp_20 [label="Sí"];
    decision3 -> calc_imp_0 [label="No"];

    // Todas las ramas convergen al cálculo del precio total
    calc_imp_500 -> calc_pretot;
    calc_imp_40 -> calc_pretot;
    calc_imp_20 -> calc_pretot;
    calc_imp_0 -> calc_pretot;

    // Final del flujo
    calc_pretot -> write_output;
    write_output -> end;
}
